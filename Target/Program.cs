using AutoGrad;
Random rnd = new();
Value a = new Value( - 4.0f, null,"a", true);
Value b = new Value(2.0f, null,"b", true);
Value c = a + b;
Value d = a * b + b.Pow(3);
c = c + c + 1;
c = c + 1 + c + ( - a);
Value k1 = (b + a);
k1 = k1.relu();
Value k2 = (b - a);
k2 = k2.relu();
d = d + d * 2 + k1;
d = d + 3 * d + k2;
Value e = c - d;
Value f = e.Pow(2);
Value g = new Value(f / 2.0f, null,"g", true);
g = g + 10.0f / f;
Console.WriteLine($"{g.ToStringExtension()}");
g.Backward();
float x = a.grad;
g.Backward();
float x2 = b.grad;
Console.WriteLine(x);
Console.WriteLine(x2);
